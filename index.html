<!DOCTYPE html>
<html lang="es" ng-app="tiendaApp">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FakeStore - Tienda Online</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body ng-controller="MainController">

    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">FakeStore</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="#" ng-click="openCartModal()">
                <span class="glyphicon glyphicon-shopping-cart"></span> 
                ${{ cartTotal | number: 2 }} 
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    
    <div class="container">
        <div id="slider-area">
            </div>

        <div ng-view>
            </div>

    </div>

    <script src="lib/angular.min.js"></script>
    
    <script src="js/app.js"></script>
    <script src="js/services/ProductService.js"></script>
    
    <style>
      /* Estilos simples para los modales */
      .modal {
          display: block;
          position: fixed;
          top: 0; left: 0;
          width: 100%; height: 100%;
          background: rgba(0,0,0,0.5);
      }

      .modal-content {
          background: white;
          margin: 10% auto;
          padding: 20px;
          width: 400px;
          border-radius: 10px;
      }

      .hidden { display: none; }
  </style>
</head>

<body ng-controller="MainController">

  <!-- LISTA DE PRODUCTOS -->
  <div ng-repeat="p in products">
      <h3>{{p.name}}</h3>
      <p>${{p.price}}</p>

      <button ng-click="openDetails(p)">Detalles</button>
      <button ng-click="updateCart(p)">Agregar</button>
  </div>

  <!-- ICONO DEL CARRITO -->
  <button ng-click="openCart()">ðŸ›’ Ver Carrito ({{cart.length}})</button>

  <!-- ===================== -->
  <!-- MODAL DE DETALLES     -->
  <!-- ===================== -->
  <div class="modal" ng-class="{'hidden': !showDetailsModal}">
      <div class="modal-content">
          <h2>{{selectedProduct.name}}</h2>
          <img ng-src="{{selectedProduct.img}}" width="200">

          <p><strong>Precio:</strong> ${{selectedProduct.price}}</p>
          <p>{{selectedProduct.description}}</p>

          <button ng-click="updateCart(selectedProduct)">Agregar al Carrito</button>
          <button ng-click="closeModals()">Cancelar</button>
      </div>
  </div>

  <!-- ===================== -->
  <!-- MODAL DEL CARRITO     -->
  <!-- ===================== -->
  <div class="modal" ng-class="{'hidden': !showCartModal}">
      <div class="modal-content">
          <h2>Carrito</h2>

          <table border="1" width="100%">
              <tr>
                  <th>Producto</th>
                  <th>Cant.</th>
                  <th>Precio</th>
              </tr>

              <tr ng-repeat="item in cart">
                  <td>{{item.name}}</td>
                  <td>{{item.quantity}}</td>
                  <td>${{item.price * item.quantity}}</td>
              </tr>
          </table>

          <h3>Total: ${{cartTotal}}</h3>

          <button ng-click="closeModals()">Cerrar</button>
      </div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="js/controllers/MainController.js"></script>
    
</body>
</html>